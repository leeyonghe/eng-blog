{%- comment -%}
Custom SEO enhancements for better structured data and Naver/Daum optimization
This includes Article schema, BreadcrumbList, and Korean-specific meta tags
{%- endcomment -%}

{%- if page.layout == "post" -%}
{%- capture article_json_ld -%}
{
  "@context": "https://schema.org",
  "@type": "Article",
  "headline": {{ page.title | jsonify }},
  "description": {{ page.excerpt | strip_html | strip | truncate: 160 | jsonify }},
  "image": {
    "@type": "ImageObject",
    "url": "{{ site.url }}{{ site.baseurl }}/assets/portfolio.png"
  },
  "datePublished": "{{ page.date | date_to_xmlschema }}",
  "dateModified": "{{ page.date | date_to_xmlschema }}",
  "author": {
    "@type": "Person",
    "name": {{ site.author.name | default: site.author | jsonify }}
  },
  "publisher": {
    "@type": "Organization",
    "name": {{ site.title | jsonify }},
    "logo": {
      "@type": "ImageObject",
      "url": "{{ site.url }}{{ site.baseurl }}/assets/portfolio.png"
    }
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "{{ page.url | absolute_url }}"
  },
  "keywords": {{ site.keywords | jsonify }},
  "articleSection": {%- if page.categories.size > 0 -%}{{ page.categories | first | jsonify }}{%- else -%}"English Learning"{%- endif -%},
  "wordCount": {{ content | strip_html | number_of_words }},
  "inLanguage": "ko-KR"
}
{%- endcapture -%}
<script type="application/ld+json">{{ article_json_ld | strip }}</script>
{%- endif -%}

{%- comment -%} BreadcrumbList for better navigation structure {%- endcomment -%}
{%- if page.layout == "post" -%}
{%- capture breadcrumb_json_ld -%}
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position": 1,
      "name": "Home",
      "item": "{{ site.url }}{{ site.baseurl }}/"
    },
    {
      "@type": "ListItem",
      "position": 2,
      "name": "Blog",
      "item": "{{ site.url }}{{ site.baseurl }}/blog/"
    },
    {
      "@type": "ListItem",
      "position": 3,
      "name": {{ page.title | jsonify }},
      "item": "{{ page.url | absolute_url }}"
    }
  ]
}
{%- endcapture -%}
<script type="application/ld+json">{{ breadcrumb_json_ld | strip }}</script>
{%- endif -%}

{%- comment -%} Naver/Daum specific meta tags {%- endcomment -%}
{%- if site.keywords -%}
<meta name="keywords" content="{{ site.keywords }}">
{%- endif -%}

{%- if page.layout == "post" -%}
{%- assign post_keywords = "" -%}
{%- if page.tags.size > 0 -%}
  {%- for tag in page.tags -%}
    {%- assign post_keywords = post_keywords | append: tag -%}
    {%- unless forloop.last -%}{%- assign post_keywords = post_keywords | append: ", " -%}{%- endunless -%}
  {%- endfor -%}
{%- endif -%}
{%- if page.categories.size > 0 -%}
  {%- if post_keywords != "" -%}{%- assign post_keywords = post_keywords | append: ", " -%}{%- endif -%}
  {%- for category in page.categories -%}
    {%- assign post_keywords = post_keywords | append: category -%}
    {%- unless forloop.last -%}{%- assign post_keywords = post_keywords | append: ", " -%}{%- endunless -%}
  {%- endfor -%}
{%- endif -%}
{%- if post_keywords != "" -%}
<meta name="keywords" content="{{ post_keywords }}, {{ site.keywords }}">
{%- endif -%}

{%- comment -%} Enhanced meta description using excerpt or custom description {%- endcomment -%}
{%- assign meta_description = "" -%}
{%- if page.description -%}
  {%- assign meta_description = page.description -%}
{%- elsif page.excerpt -%}
  {%- assign meta_description = page.excerpt | strip_html | strip | truncate: 160 -%}
{%- else -%}
  {%- assign meta_description = site.description | strip_html | strip | truncate: 160 -%}
{%- endif -%}
<meta name="description" content="{{ meta_description }}">

{%- comment -%} Open Graph enhancements for social sharing {%- endcomment -%}
<meta property="og:description" content="{{ meta_description }}">
{%- if page.layout == "post" -%}
<meta property="og:type" content="article">
<meta property="article:published_time" content="{{ page.date | date_to_xmlschema }}">
<meta property="article:author" content="{{ site.author.name | default: site.author }}">
{%- if page.categories.size > 0 -%}
<meta property="article:section" content="{{ page.categories | first }}">
{%- endif -%}
{%- if page.tags.size > 0 -%}
{%- for tag in page.tags -%}
<meta property="article:tag" content="{{ tag }}">
{%- endfor -%}
{%- endif -%}
{%- endif -%}

{%- comment -%} Twitter Card enhancements {%- endcomment -%}
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:description" content="{{ meta_description }}">

{%- comment -%} Naver specific tags {%- endcomment -%}
<meta name="naver-site-verification" content="{{ site.naver_site_verification }}">
{%- if page.layout == "post" -%}
<meta property="naverblog" content="noindex">
<meta name="robots" content="index,follow">
{%- endif -%}
{%- endif -%}

{%- comment -%} Language and locale {%- endcomment -%}
<meta property="og:locale" content="ko_KR">
<meta property="og:locale:alternate" content="en_US">